function renderHome() {
    document.getElementById('totalJuntadas').textContent = juntadasData.length;

    // Asistencia del usuario
    const usuario = culpososData.find(c => c.Email && c.Email.toLowerCase() === currentUser);
    let asistenciaHTML = '-';
    if (usuario) {
        const porcentaje = parseFloat(usuario.Porcentaje || 0).toFixed(0);
        let color = '#f44336';
        if (porcentaje >= 90) color = '#4CAF50';
        else if (porcentaje >= 70) color = '#8BC34A';
        else if (porcentaje >= 40) color = '#FF9800';
        asistenciaHTML = `<span style="color:${color}">${porcentaje}%</span>`;
    }
    document.getElementById('totalCulposos').innerHTML = asistenciaHTML;
    document.querySelector('#totalCulposos').nextElementSibling.textContent = 'Tu Asistencia';

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    //  PrÃ³xima Juntada
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const hoy = new Date();
    hoy.setHours(0,0,0,0);

    let proxima = null;
    let proximaIdx = -1;

    for (let i = 0; i < juntadasData.length; i++) {
        const f = juntadasData[i].Fecha?.trim();
        if (!f) continue;
        const partes = f.split('/');
        if (partes.length !== 3) continue;
        const fecha = new Date(partes[2], partes[1]-1, partes[0]);
        if (!isNaN(fecha) && fecha >= hoy) {
            proxima = juntadasData[i];
            proximaIdx = i;
            break;
        }
    }

    let htmlProxima = '';

    if (proxima && usuario) {
        const nombre = usuario.Nombre;
        const respuesta = proxima[nombre];
        const yaRespondio = respuesta === 'âœ“' || respuesta === 'âœ—';

        htmlProxima = `
            <div class="section-title" style="margin: 30px 0 16px 0;">ğŸ¯ PrÃ³xima Juntada</div>
            <div class="card" style="border-left: 5px solid #FFD700; background: linear-gradient(135deg, rgba(255,215,0,0.14) 0%, rgba(255,215,0,0.04) 100%);">
                <div class="card-date" style="font-size:14px;">${proxima.Fecha}</div>
                <div class="card-title" style="font-size:21px; margin:10px 0 12px;">${proxima.DescripciÃ³n || proxima.Descripcion || 'Juntada'}</div>
                <div class="card-details" style="margin-bottom:16px;">
                    <span>ğŸ  ${proxima.Host || 'Sin host'}</span>
                </div>

                ${yaRespondio ? `
                    <div style="padding:16px; text-align:center; border-radius:10px; background:${respuesta==='âœ“'?'rgba(76,175,80,0.22)':'rgba(244,67,54,0.22)'};">
                        <div style="font-weight:bold; font-size:16px; color:${respuesta==='âœ“'?'#4CAF50':'#f44336'};">
                            ${respuesta==='âœ“' ? 'âœ… Ya confirmaste que vas' : 'âŒ Confirmaste que NO vas'}
                        </div>
                        <button onclick="abrirModalConfirmar(${proximaIdx})" style="margin-top:12px; padding:8px 18px; background:rgba(255,255,255,0.12); border:1px solid #FFD700; color:#FFD700; border-radius:8px; font-size:13px; cursor:pointer;">
                            Cambiar respuesta
                        </button>
                    </div>
                ` : `
                    <button onclick="abrirModalConfirmar(${proximaIdx})" style="width:100%; padding:16px; margin-top:12px; background:linear-gradient(135deg, #FFD700, #FFAA00); color:#1a1a2e; font-weight:bold; font-size:17px; border:none; border-radius:12px; box-shadow:0 4px 14px rgba(255,215,0,0.35); cursor:pointer;">
                        ğŸ“ Confirmar asistencia
                    </button>
                `}
            </div>
        `;
    } else if (usuario) {
        htmlProxima = `
            <div class="section-title" style="margin: 30px 0 16px 0;">ğŸ¯ PrÃ³xima Juntada</div>
            <div class="card" style="text-align:center; padding:35px 20px; background:rgba(139,77,143,0.10);">
                <div style="font-size:50px; margin-bottom:12px;">ğŸ“…</div>
                <div style="font-size:17px; color:rgba(255,255,255,0.9);">
                    No hay juntada programada aÃºn
                </div>
                <div style="margin-top:10px; color:rgba(255,255,255,0.55); font-size:14px;">
                    AparecerÃ¡ aquÃ­ cuando se agregue una nueva
                </div>
            </div>
        `;
    }

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    //  Ãšltimas Juntadas
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const ultimas = juntadasData.slice(-4).reverse(); // â† podÃ©s cambiar a -3 o -5

    let htmlUltimas = ultimas.length === 0 ? 
        '<p style="text-align:center; padding:30px; color:rgba(255,255,255,0.6);">No hay juntadas registradas todavÃ­a</p>' :
        ultimas.map((j, idx) => {
            const realIdx = juntadasData.length - 1 - idx;
            return `
                <div class="card" onclick="verDetalleJuntada(${realIdx})" style="cursor:pointer; transition:transform 0.18s;" onmouseover="this.style.transform='scale(1.015)'" onmouseout="this.style.transform='scale(1)'">
                    <div class="card-date">${j.Fecha || ''}</div>
                    <div class="card-title">${j.DescripciÃ³n || j.Descripcion || 'Juntada'}</div>
                    <div class="card-details">
                        <span>ğŸ  ${j.Host || 'â€”'}</span>
                        <span style="margin-left:14px;">ğŸ‘¥ ${j['NÂ° Asist'] || j['NÂ° asistentes'] || j['NÂ° Asistentes'] || '0'}</span>
                    </div>
                </div>
            `;
        }).join('');

    // Contenedor final
    document.getElementById('ultimasJuntadas').innerHTML = `
        ${htmlProxima}
        <div class="section-title" style="margin: 40px 0 16px 0;">ğŸ•’ Ãšltimas Juntadas</div>
        ${htmlUltimas}
    `;
}
